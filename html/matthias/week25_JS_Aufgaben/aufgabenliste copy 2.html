<!-- 
Aufgabe: Aufgabenliste
1/ Erstelle eine Aufgabenliste mit den Feldern:
Aufgabe, Datum und einem Hinzufügen-Button.
2/ Speichere die Eingaben in einem JavaScript-Array.
3/ Ergänze die Aufgaben im DOM.
4/ Mach es möglich, Aufgaben zu bearbeiten.
5/ Mach es möglich Aufgaben zu löschen.
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Aufgabenliste</title>
</head>

<h1>Meine Aufgabenliste</h1> 
<div id="box">
    <input type="text" id="aufgabe" placeholder="Aufgabe eingeben">
    <input type="date" id="datum">
    <button id="hinzuf"     	onclick="aufgabeHinzufuegen()">Hinzufügen</button>
    <button id="speichern"      onclick="speichern()">Speichern</button>
</div>
<ul id="aufgabenListe"></ul>

<script>
     var arrayList= JSON.parse(window.localStorage.getItem('Aufgaben'));
     
    aktuallisieren();

function aufgabeHinzufuegen() {
    const aufgabeInput = document.getElementById("aufgabe");
    const datumInput = document.getElementById("datum");
    const aufgabe = aufgabeInput.value;
    const datum = datumInput.value;
    var struct = {Aufgabe: aufgabe, Datum: datum,} ;
    if (aufgabe && datum) {
        struct.Aufgabe=aufgabe;
        struct.Datum=datum;
        arrayList.push(struct);
        window.localStorage.setItem('Aufgaben', JSON.stringify(arrayList));
        console.log("Aufgaben: " , JSON.parse(window.localStorage.getItem('Aufgaben')));
    }
    aktuallisieren();
}

function aktuallisieren(){
    const aufgabenListe = document.getElementById("aufgabenListe");
    aufgabenListe.innerHTML = "";
    document.getElementById("aufgabe").value="";
    document.getElementById("datum").value="";
    console.log("Aufgaben Liste:",arrayList);
    console.log("Aufgaben Liste:",arrayList[0].Aufgabe);
        for (var i in arrayList) {
            console.log(i);
            const li = document.createElement("li");
            li.textContent = arrayList[i].Aufgabe + " (fällig am " + arrayList[i].Datum;
            // Button zum Bearbeiten
            const bearbeitenButton = document.createElement("button");
            bearbeitenButton.textContent = "Bearbeiten";
            bearbeitenButton.onclick = () => aufgabeBearbeiten(i);
            li.appendChild(bearbeitenButton);
            // Button zum Löschen
            const loeschenButton = document.createElement("button");
            loeschenButton.textContent = "Löschen";
            loeschenButton.onclick = () => aufgabeLoeschen(i);
            li.appendChild(loeschenButton);
             aufgabenListe.appendChild(li);
        }
}

function speichern(){
            var aufgabe = document.getElementById("aufgabe").value;
            var datum = document.getElementById("datum").value;
            arrayList[speicherIndex].Aufgabe=aufgabe;
            arrayList[speicherIndex].Datum=datum;
            window.localStorage.setItem('Aufgaben', JSON.stringify(arrayList));
            aufgabeLoeschen(speicherIndex);
}

var speicherIndex=0;
function aufgabeBearbeiten(index) {
    var temp=index;
    speicherIndex=index;
    console.log("Index:"+index);
        if (!isNaN(document.getElementById("aufgabe").value)) {
            document.getElementById("aufgabe").value=arrayList[temp].Aufgabe;
            document.getElementById("datum").value=arrayList[temp].Datum;
        }
    }

    // Funktion zum Löschen einer Aufgabe
    function aufgabeLoeschen(index) {
        arrayList.splice(index,1);
        window.localStorage.setItem('Aufgaben', JSON.stringify(arrayList));
        aktuallisieren();
    }

</script>
</body>
</html

