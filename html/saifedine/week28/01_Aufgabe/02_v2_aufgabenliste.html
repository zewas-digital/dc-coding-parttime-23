<!-- 
Aufgabe: Aufgabenliste
1/ Erstelle eine Aufgabenliste mit den Feldern:
Aufgabe, Datum und einem Hinzufügen-Button.
2/ Speichere die Eingaben in einem JavaScript-Array.
3/ Ergänze die Aufgaben im DOM.
4/ Mach es möglich, Aufgaben zu bearbeiten.
5/ Mach es möglich Aufgaben zu löschen.

var (alt) = ersetzt durch let & const
const = Konstant und wird nicht mehr geändert im Programmablauf (z.B. Geburtstag)
let (neu) = erstetzt var - Achtung Scope berücksichtigen
let innerhalb einer Funktion kann nicht global verwendet werden, selbst wenn die gleiche Variable innerhalb und außerhalb der Funktion vorhanden ist.

z.B.

let i = 0;

function () {

  let i = 5;
}

let i = 0 hat nichts mit let i = 5 zu tun und beide sind unabhängig!

refactorings:

Variablen-Typen neu aufsetzen lt. Beschreibung oben
Variablen global definieren
Array-Objekt mit Beispielen implementieren, damit Beispieldaten vorhanden sind. Objekt-id (input-Feld , hidden) implementieren und eindeutige id vergeben.
Objekt in Session Storage speichern (JSON.stringify & JSON.parse)
Mehrfachauswahl (Checkbox) und deren Funktionalität berücksichtigen (z.B. mehrfachauswahl für Löschen soll möglich sein....)
Button disablen, wenn sie nicht verwendet werden sollen
innerHTML zum Anlegen der Elemente in der DOM ablösen!!!
-->



<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aufgabenliste</title>
</head>

<body>
  <h1>Aufgabenliste</h1>

  <input type="text" id="aufgabe" placeholder="Enter task" />
  <input type="date" id="kalender" />
  <button onclick="saveTask()">Add task</button>
  <button onclick="changeTask()">Change task</button>
  <button onclick="deleteTask()">Delete task</button>


  <ol id="tasklist"></ol>

  <script>
    'use strict'

    const taskElement = document.getElementById("aufgabe");
    const kalenderElement = document.getElementById("kalender");
    const taskContainer = document.getElementById("tasklist");

    let count = 0;
    let editIndex;

    // Beispieldaten
    let toDoListe = [
      {
        iD: 1,
        taskName: "Einkaufen",
        taskDate: "2024-04-11"
      },
      {
        iD: 2,
        taskName: "Lernen",
        taskDate: "2024-04-12"
      },
      {
        iD: 3,
        taskName: "Sport",
        taskDate: "2024-04-13"
      }
    ];

    console.log(typeof toDoListe, "Beispieldaten: ", toDoListe);


    function saveBeispielDaten() {

      // DOM
      let liElement = document.createElement("li");
      taskContainer.appendChild(liElement);

      let inputElement = document.createElement("input");
      liElement.appendChild(inputElement);

      // Local oder Session Storage 
    }








    // Funktion zum Speichern der angelegten Aufgaben inkl. Datum
    function saveTask() {

      // angelegte Variablen (task, kalender), wo der Wert im Input-Feld gespeichert wird.
      let task = taskElement.value;
      let kalender = kalenderElement.value;

      // jedes mal wenn eine Aufgabe angelegt wird, erhöht sich der count
      count++;

      // Array, die alle Informationen zur Aufgabe beinhaltet
      let array = [task, kalender, count];

      // Testausgabe 1 - eigene:
      console.log("JavaScript-Array: " + "Task " + array[0] + " Fällig " + array[1] + " " + count);

      // Testausgabe 2 - Marcel:
      console.log(`JavaScript-Array: Task ${array[0]} Fällig ${array[1]}`);

      // speichert, den Key (count) mit dem Wert (array) in die Session Storage
      sessionStorage.setItem(count, array);

      // Testausgabe:
      console.log("Aufgaben-Array: " + array);

      // Funktion, die das Aufgaben-Element zur DOM hinzufügt
      addToDom(array);

      // Funktion, die die Input-Felder (aufgabe & kalender) beim Speichern löscht
      clearInput(array);
    }

    // Funktion, die das Aufgaben-Element zur DOM hinzufügt
    function addToDom(array) {

      // beim Anlegen und speichern einer neuen Aufgabe, wird dynamisch ein Aufgaben-Element zur DOM hinzugefügt
      taskContainer.innerHTML += '<li><input onchange="addToInput(' + count + ')" type="checkbox" id="selection' + count + '" name="select ' + count + '" + /> Aufgabe: ' + ' ' + array[0] + ', Fälligkeit bis: ' + array[1] + ' ' + array[2] + '</li>';
    }


    function clearInput() {

      taskElement.value = "";
      kalenderElement.value = "";
    }

    function addToInput(count) {

      editIndex = count;

      let data = sessionStorage.getItem(count);

      let checkboxChecked = document.getElementById('selection' + count).checked;

      //console.log("Checkbox ist ausgewählt1: " + data);

      if (checkboxChecked) {
        console.log("Checkbox ist ausgewählt2: " + data);
      } else {
        console.log("Du kommst do ned rein");
      }

      let tmp = data.split(",");

      console.log("Was ist tmp: ", tmp);
      console.log("Type: ", typeof tmp);


      // Aufgabe-Text in Input-Feld:
      let toDo = taskElement;
      // es macht ein unterschied ob , oder + in der Ausgabe in der Console!!!!!!!!!!!!!!!!!!!
      console.log("Task: ", toDo);
      toDo.value = tmp[0];
      console.log("gewählte Aufgabe: " + toDo.value);

      let kalender = kalenderElement;
      kalender.value = tmp[1];
      console.log("Type: ", typeof kalender, "Datum: ", kalender.value);

      // to Do - funktioniert noch nicht !!!!!!!!!!
      if (!checkboxChecked) {
        clearInput();
      }

    }

    function changeTask(array) {

      deleteTask();
      saveTask();


    }


    function deleteTask(array) {

      sessionStorage.removeItem(editIndex);

      let domElement = document.getElementById('selection' + editIndex).parentElement;

      console.dir(domElement);

      domElement.remove();

      console.dir(domElement);

      clearInput();


    }



  </script>
</body>

</html>